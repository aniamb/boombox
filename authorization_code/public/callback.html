<!-- <html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <script>
        var client_id = '5bdc26b569de48d388e9a279f91cdc8a'; // Your client id
        var client_secret = '979e281a27854522852cc89f56f86daf'; // Your secret
        //var access_token = (client_id + ':' + client_secret).toString('base64');


        // function getUsername(callback) {
        //     console.log('getUsername');
        //     var url = 'https://api.spotify.com/v1/me';
        //     $.ajax(url, {
        //         dataType: 'json',
        //         headers: {
        //             'Authorization': 'Bearer ' + access_token
        //         },
        //         success: function(r) {
        //             console.log('got username response', r);
        //             callback(r.id);
        //         },
        //         error: function(r) {
        //             callback(null);
        //         }
	    //     });
        // }

        

        function createPlaylist(username, playlistName, callback) {
            console.log('createPlaylist', username, name);
            var url = 'https://api.spotify.com/v1/users/' +username +'/playlists';
            $.ajax(url, {
                method: 'POST',
                data: JSON.stringify({
        			'name': name,
        			'public': true
	        	}),
                dataType: 'json',
                headers: {
                    'Authorization': 'Bearer ' + access_token,
                    'Content-Type': 'application/json'
                },
                success: function(r) {
                    console.log('create playlist response', r);
                    callback(r.id);
                },
                error: function(r) {
                    callback(null);
                }
            });
        }

        function searchPlaylists(username, keyword, callback) {
            console.log('searchPlaylists', username, keyword);
            var url = 'https://api.spotify.com/v1/search/';
            $.ajax(url, {
                method: 'GET',
                data: JSON.stringify({
        			'q': keyword,
                    'type': 'playlist',
                    'limit': 5
	        	}),
                dataType: 'json',
                headers: {
                    'Authorization': 'Bearer ' + access_token,
                    'Content-Type': 'application/json'
                },
                success: function(r) {
                    console.log('create playlist response', r);
                    callback(r.id);
                },
                error: function(r) {
                    callback(null);
                }
            });
        }

        function addTracktoPlaylists(username, playlistID, trackURI, callback) {
            console.log('searchPlaylists', username, playlistID, trackURI);
            var url = 'https://api.spotify.com/v1/playlists/' + playlistID + '/tracks';
            $.ajax(url, {
                method: 'POST',
                data: JSON.stringify({
        			'playlist_id': playlistID,
                    'uris': trackURI,
	        	}),
                dataType: 'json',
                headers: {
                    'Authorization': 'Bearer ' + access_token,
                    'Content-Type': 'application/json'
                },
                success: function(r) {
                    console.log('create playlist response', r);
                    callback(r.id);
                },
                error: function(r) {
                    callback(null);
                }
            });
        }

        function getSpotifyData() {

            function getHashParams() {
                var hashParams = {};
                var e, r = /([^&;=]+)=?([^&;]*)/g,
                    q = window.location.hash.substring(1);
                while ( e = r.exec(q)) {
                    hashParams[e[1]] = decodeURIComponent(e[2]);
                }

                return hashParams;
            }

            var params = getHashParams();

            var access_token = params.access_token,
                refresh_token = params.refresh_token,
                error = params.error;
            
            console.log(params);
            console.log(access_token);

            function getUsername(callback) {
                console.log('getUsername');
                var url = 'https://api.spotify.com/v1/me';
                $.ajax(url, {
                    dataType: 'json',
                    headers: {
                        'Authorization': 'Bearer ' + access_token
                    },
                    success: function(r) {
                        console.log('got username response', r);
                        callback(r.id);
                    },
                    error: function(r) {
                        callback(null);
                    }
                });
            }


        
            
            console.log('yeahhhh' + access_token);
          //  g_name = localStorage.getItem('createplaylist-name');
              g_name = "hello world";

            // if ('access_token' != 'undefined') {
            //     // got access token
            //     console.log('got access token', args['access_token']);
            //     access_token = args['access_token'];
            // }
            
            var user = getUsername(function(username) {
                console.log('got username', username);
                
                //search for playlists
                    //store playlist id
                //search for songs in each playlist
                    //store songs in database
                // createPlaylist(username, g_name, function(playlist) {
                //     //add songs to playlist
                //     console.log('created playlist', playlist);
                // });
            });

        }
        </script>

    </head>
    <body onload="getSpotifyData()">
        <h1> check spotify yo</h1>
        <p> </p>
        

    </body>
</html> -->